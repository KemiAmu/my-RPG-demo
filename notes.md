# 游戏架构图

这是一个 MarkMap 图示，你可以在 [markmap.js.org](https://markmap.js.org/) 中查看。

## 要素注释
- 剧情 & 进度
- 玩家 & 实体 & NPC & 怪物 & 冲刺动作
- 开放世界玩法 & 多场景地图
- 弹幕 & 回合对战 & 独立对战场景
- 物品背包 & 状态效果 & 还未明确但需要拓展的机制

## 全局上下文调度
### 事件总线
- 战斗开始
- 伤害触发
- 剧情推进
- UI 刷新
### 剧情行为树
- 黑板系统 & 进度标志 & 分支标志 & 计数器标志
- 对话树 & 条件分支
- 事件广播
### 人机交互 & 指示系统
- 镜头管理 & 画面调度
- UI 管理

## 子系统
### 玩家管理
- 全局玩家实体控制器
- 属性系统
- 状态机
- 状态效果机制
- 背包系统
### 战斗系统
- 行为调度 & 上下文调度
- 动作执行器 & 攻击判定
- 技能 & 道具
- 回合调度
- 弹幕碰撞管理
### 物品枚举
- 类别 & 特性 & 效用
- 附加属性
- 序列化接口
### 序列化存储
- 玩家数据
- 进度数据

## 节点接口
### 实体基类
- 玩家实体
- 怪物实体（多态）
- NPC 实体（多态）
- 实体 & 非生物
### 场景基类
- 世界场景
- 战斗场景
### 组件系统
- 实体对战行为接口
- 实体对话行为接口
- 场景预制件

## 根节点
### 世界场景（动态替换）
- WorldPlayer
- NPC？
- 怪物？
- 场景地图
- 区域触发器？
- WorldCamera
### 战斗场景（动态替换）
- BattlePlayer
- 怪物
- 场景地图
- CombatCamera
### UI容器
- 全局HUD
- 对话框
- 战斗 UI
- 菜单界面
